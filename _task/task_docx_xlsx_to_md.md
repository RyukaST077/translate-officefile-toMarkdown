## PR-001: プロジェクト雛形と最小GUIスケルトン [ ]
- 目的:
  - 開発の土台（ディレクトリ構成、エントリポイント、依存関係、最小GUI）を整備する
- 前提条件:
  - [ ] なし
- 変更予定ファイル:
  - 新規 `requirements.txt`
  - 新規 `src/app/__init__.py`
  - 新規 `src/app/main.py`
  - 新規 `src/app/config.py`
  - 新規 `src/app/ui/main_window.py`
- 実行タスク:
  - [ ] ディレクトリ構成（`src/app`, `src/app/ui`, `src/app/core`）を作成する
  - [ ] 依存関係を定義する（`markitdown[docx,xlsx,xls]`, `openpyxl`, `pyinstaller` を明記）
  - [ ] アプリ基本設定（アプリ名・バージョン・ログファイル名など）を `config.py` に定義する
  - [ ] Tkinterの最小UI（入力フォルダ選択、出力先表示、実行ボタン、進捗バー、ステータス）を配置した `MainWindow` を作成する（動作はまだ紐付けない）
  - [ ] `main.py` からウィンドウを起動できることを確認する
- 受け入れ基準:
  - [ ] `python -m app.main` で空のGUIが起動し、主要UI部品が画面に表示される
  - [ ] 依存関係一覧が揃い、次PRから実装可能な土台ができている

---

## PR-002: 出力計画とファイル探索の実装 [ ]
- 目的:
  - 出力フォルダ/ファイル名の衝突回避ロジックと、対象ファイル探索ロジックを実装する
- 前提条件:
  - [ ] PR-001 がマージ済み
- 変更予定ファイル:
  - 新規 `src/app/core/output_planner.py`
  - 新規 `src/app/core/file_scanner.py`
  - 新規 `src/app/core/path_utils.py`
- 実行タスク:
  - [ ] 出力フォルダの連番付与ルールを実装する（`_md`, `_md_2`, `_md_3`…）
  - [ ] 出力ファイル名の連番付与ルールを実装する（`a.md`, `a_2.md`, `a_3.md`…）
  - [ ] 相対パス維持の出力パス生成を実装する
  - [ ] 再帰探索で `.docx`, `.xls`, `.xlsx` を抽出する（大文字小文字無視）
  - [ ] 除外ルールを実装する（`~$*` と入力配下に存在する `*_md*` フォルダ）
  - [ ] 例外系（アクセス不可パス）の扱いを明確化し、呼び出し側へ伝播できる形にする
- 受け入れ基準:
  - [ ] 入力フォルダと同階層に、上書きしない出力フォルダが決定できる
  - [ ] 同名衝突時の `.md` 連番が正しく決まる
  - [ ] 対象拡張子のみが収集され、除外ルールが機能する

---

## PR-003: 変換コア（MarkItDown連携・画像/数式対応） [ ]
- 目的:
  - MarkItDownを用いた変換処理と、画像/数式の扱いを仕様通りに整備する
- 前提条件:
  - [ ] PR-001 がマージ済み
  - [ ] PR-002 がマージ済み
- 変更予定ファイル:
  - 新規 `src/app/core/document_converter.py`
  - 新規 `src/app/core/excel_image_detector.py`
  - 新規 `src/app/core/markdown_postprocessor.py`
- 実行タスク:
  - [ ] `MarkItDown(enable_plugins=False)` を用いた変換処理を実装する
  - [ ] `.xlsx` に対して `openpyxl` で画像有無を検出する（検出不能時はスキップ＋ログ用情報を返す）
  - [ ] 画像のMarkdown埋め込み（`![](...)` など）を除去する後処理を実装する
  - [ ] 画像検出時の注記ルールを **要件優先** で実装する（例：シート見出しに「画像あり」を付与）
  - [ ] 数式は表示値のみ（MarkItDown結果を採用）とし、取得不可時に警告情報を返す
  - [ ] Excel複数シートが `## SheetName` で分割されているか検証し、必要なら後処理で補正する
- 受け入れ基準:
  - [ ] `.docx/.xls/.xlsx` が1ファイル→1 `.md` に変換される
  - [ ] 画像は埋め込まれず、検出できた場合のみ注記が付く
  - [ ] 数式は結果値のみが出力され、取得不可時は警告情報が得られる
  - [ ] Excelの複数シートが1つのmd内に見出し区切りで出力される

---

## PR-004: 変換制御・進捗表示・ログ/完了ダイアログ [ ]
- 目的:
  - 変換処理をワーカースレッドで実行し、UIと連携して進捗・結果を表示できるようにする
- 前提条件:
  - [ ] PR-001 がマージ済み
  - [ ] PR-002 がマージ済み
  - [ ] PR-003 がマージ済み
- 変更予定ファイル:
  - 新規 `src/app/controllers/conversion_controller.py`
  - 新規 `src/app/models/progress_event.py`
  - 新規 `src/app/core/logger.py`
  - 変更 `src/app/ui/main_window.py`
- 実行タスク:
  - [ ] 変換の開始/終了を制御する `ConversionController` を実装する
  - [ ] ワーカースレッドで変換を実行し、進捗イベント（n/total, 処理中ファイル）をUIに通知する
  - [ ] 入力フォルダ選択時に出力先プレビューを自動更新する
  - [ ] 実行中は入力再選択と実行ボタンを無効化する
  - [ ] `conversion.log` を出力フォルダ配下に生成し、成功/失敗/警告を記録する
  - [ ] 完了時に成功/失敗件数・出力先・ログ案内を表示するダイアログを実装する
- 受け入れ基準:
  - [ ] UIがフリーズせず、進捗バーとステータスが更新される
  - [ ] 変換失敗があっても処理が継続し、ログに記録される
  - [ ] 完了ダイアログに成功/失敗件数と出力先が表示される

---

## PR-005: 配布/ビルド設定（PyInstaller + GitHub Actions） [ ]
- 目的:
  - Windows配布に必要なビルド/リリース基盤を整備する
- 前提条件:
  - [ ] PR-001 がマージ済み
  - [ ] PR-004 がマージ済み
- 変更予定ファイル:
  - 新規 `build/pyinstaller.spec`
  - 新規 `.github/workflows/build-release.yml`
  - 新規 `installer/README.md`
- 実行タスク:
  - [ ] PyInstallerのone-dirビルド設定を作成し、Python同梱で起動できることを確認する
  - [ ] GitHub ActionsでWindowsビルド→成果物生成→Releases添付の流れを定義する
  - [ ] インストーラー作成手順（Inno Setup想定）を `installer/README.md` に明記する
- 受け入れ基準:
  - [ ] GitHub ActionsでWindowsビルドが成功し、成果物が生成される
  - [ ] Releasesにインストーラーを添付できるフローが明文化されている

---

更新日: 20251224
バージョン: 1.0.0
